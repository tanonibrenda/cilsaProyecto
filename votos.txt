import csv

# Función para cargar los datos desde el archivo CSV
def cargar_datos(archivo):
    with open(archivo, newline='', encoding='utf-8') as csvfile:
        reader = csv.DictReader(csvfile)
        return list(reader)

# Función para filtrar personas por DNI y nombre
def filtrar_personas(datos, dni_limite, nombre):
    return [persona for persona in datos if int(persona['DNI']) > dni_limite and persona['Nombre'] == nombre]

# Función para guardar en un archivo de texto personas con apellido "Gonzalez"
def guardar_gonzalez(datos):
    with open('gonzalez.txt', 'w', encoding='utf-8') as file:
        for persona in datos:
            if persona['Apellido'] == 'Gonzalez':
                file.write(f"{persona['Nombre']} {persona['Apellido']}\n")

# Nombre del archivo CSV
archivo_csv = 'votos.csv'

# Cargar los datos desde el archivo CSV
datos_votos = cargar_datos(archivo_csv)

# Tarea 2: Mostrar personas con DNI mayor a 40,000,000 y nombre "Juan"
personas_juan = filtrar_personas(datos_votos, 40000000, 'Juan')
print("\nPersonas con DNI mayor a 40,000,000 y nombre 'Juan':")
for persona in personas_juan:
    print(persona)

# Tarea 3: Guardar en un archivo de texto las personas con apellido "Gonzalez"
personas_gonzalez = [persona for persona in datos_votos if persona['Apellido'] == 'Gonzalez']
guardar_gonzalez(personas_gonzalez)
print("\nSe han guardado las personas con apellido 'Gonzalez' en gonzalez.txt")
